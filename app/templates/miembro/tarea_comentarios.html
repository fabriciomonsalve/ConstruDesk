{% extends "layout.html" %}
{% block content %}
<div class="min-h-screen py-8">
  <div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-[90%]">
    <div class="bg-white rounded-3xl shadow-xl p-6 sm:p-8 lg:p-10">

      <a href="{{ url_for('miembro.tareas_asignadas') }}" class="text-blue-600 hover:underline mb-4 inline-block">
        ‚Üê Volver a mis tareas
      </a>

      <h1 class="text-2xl font-bold text-gray-900 mb-2">{{ tarea.name }}</h1>
      <p class="text-gray-600 mb-6">{{ tarea.description or 'Sin descripci√≥n' }}</p>

      <div class="border-t border-gray-200 pt-6">
        <h2 class="text-lg font-semibold mb-4 text-gray-900">üí¨ Comentarios</h2>

        <!-- üîπ Contenedor din√°mico -->
        <div id="comments-list">
          {% include 'miembro/_comentarios_partial.html' %}
        </div>

        <form method="POST" class="mt-6">
          <textarea name="content" rows="3"
            class="w-full border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            placeholder="Escribe un comentario..."></textarea>
          <button type="submit"
            class="mt-3 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-all">
            Enviar
          </button>
        </form>
      </div>

    </div>
  </div>
</div>

<!-- üîÅ Script de actualizaci√≥n autom√°tica -->
<script>
async function loadComments() {
  const url = "{{ url_for('miembro.comentarios_tarea', tarea_id=tarea.id) }}?ajax=1";
  const res = await fetch(url);
  const html = await res.text();
  document.getElementById('comments-list').innerHTML = html;
}

setInterval(loadComments, 3000); // cada 5 segundos
</script>
{% endblock %}
